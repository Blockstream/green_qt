linux-x86_64:build-image:
  extends: .docker_build
  variables:
    IMAGE: $CI_REGISTRY_IMAGE/linux-x86_64
    DOCKER_FILE: ci/linux-x86_64/Dockerfile

.linux-x86_64:
  image: $CI_REGISTRY_IMAGE/linux-x86_64@sha256:f58c1afe95b49fe9d5c864fde52a9c0b84b410bdb43f721f91657351b08a3bef
  extends:
    - .build
  tags:
    - cloud

linux-x86_64:build-appimage:
  extends:
    - .linux-x86_64
  after_script:
    - mv build/blockstream .
    - tools/appimage.sh $CI_PROJECT_DIR
  artifacts:
    name: "$CI_PROJECT_NAME-$CI_JOB_NAME-$CI_COMMIT_SHORT_SHA"
    expire_in: 1 week
    paths:
      - Blockstream-x86_64.AppImage

linux-x86_64:build-binary:
  extends:
    - .linux-x86_64
  after_script:
    - mv build/blockstream .
  variables:
    GREEN_WAYLAND: "ON"
  artifacts:
    name: "$CI_PROJECT_NAME-$CI_JOB_NAME-$CI_COMMIT_SHORT_SHA"
    expire_in: 1 week
    paths:
      - blockstream
